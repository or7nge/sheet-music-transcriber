<!doctype html>
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <title>Sheet Music Transcriber Studio</title>
    <meta
      name="description"
      content="Upload sheet music and transcribe it into ABC, MIDI, and MusicXML with a refined browser-based workflow."
    />
    <link rel="preconnect" href="https://fonts.googleapis.com" />
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
    <link
      href="https://fonts.googleapis.com/css2?family=Fraunces:opsz,wght@9..144,400;9..144,600&family=Plus+Jakarta+Sans:wght@400;500;600;700&family=IBM+Plex+Mono:wght@400;500&display=swap"
      rel="stylesheet"
    />
    <link rel="stylesheet" href="/styles.css" />
  </head>
  <body>
    <canvas id="constellation" aria-hidden="true"></canvas>
    <div class="atmosphere" aria-hidden="true"></div>

    <main class="shell">
      <header class="hero reveal" style="--delay: 0.02s">
        <p class="eyebrow">Optical Music Recognition</p>
        <h1>Sheet Music Transcriber Studio</h1>
        <p class="lede">
          A focused browser workspace for converting printed scores into clean
          digital notation artifacts.
        </p>
        <div class="hero-badges">
          <span>JPG / PNG / PDF Input</span>
          <span>ABC Notation Output</span>
          <span>MIDI + MusicXML Export</span>
        </div>
      </header>

      <section class="workspace">
        <article class="panel input-panel reveal" style="--delay: 0.1s">
          <div class="panel-title-row">
            <h2>Input</h2>
            <p id="fileMetaHint">Choose one score to transcribe</p>
          </div>

          <label for="fileInput" id="dropzone" class="dropzone">
            <input id="fileInput" type="file" accept=".jpg,.jpeg,.png,.pdf" hidden />
            <div class="dropzone-icon" aria-hidden="true">â™ª</div>
            <p class="dropzone-title">Drop file or click to upload</p>
            <p class="dropzone-copy">Use high-resolution scans for best output.</p>
          </label>

          <div id="fileChip" class="file-chip" hidden>
            <div class="file-chip-name" id="fileName"></div>
            <div class="file-chip-meta" id="fileMeta"></div>
          </div>

          <button id="runButton" class="run-button" disabled>
            Transcribe Score
          </button>

          <div class="progress-wrap">
            <div class="progress-track">
              <div id="progressBar" class="progress-bar"></div>
            </div>
            <p id="progressText" class="progress-text">Waiting for a file.</p>
          </div>

          <ol id="pipeline" class="pipeline" aria-label="Transcription stages">
            <li data-stage="queued">Queued</li>
            <li data-stage="validating">Validate Runtime</li>
            <li data-stage="preparing">Prepare Input</li>
            <li data-stage="recognizing">Recognize Notation</li>
            <li data-stage="converting_abc">Generate ABC</li>
            <li data-stage="converting_midi">Generate MIDI</li>
            <li data-stage="packaging">Package Outputs</li>
            <li data-stage="complete">Complete</li>
          </ol>
        </article>

        <article class="panel output-panel reveal" style="--delay: 0.18s">
          <div class="panel-title-row">
            <h2>Output</h2>
            <p id="statusBadge" class="status-badge idle">Idle</p>
          </div>

          <div id="previewWrap" class="preview-wrap" hidden>
            <img id="previewImage" alt="Uploaded score preview" />
          </div>

          <div class="tabs" role="tablist" aria-label="Output tabs">
            <button class="tab is-active" data-tab="abc" role="tab" aria-selected="true">ABC</button>
            <button class="tab" data-tab="midi" role="tab" aria-selected="false">MIDI</button>
            <button class="tab" data-tab="musicxml" role="tab" aria-selected="false">MusicXML</button>
            <button class="tab" data-tab="log" role="tab" aria-selected="false">Log</button>
          </div>

          <section class="tab-panel is-active" id="tab-abc" role="tabpanel">
            <div class="tab-toolbar">
              <button id="copyAbcButton" class="secondary">Copy ABC</button>
            </div>
            <pre id="abcOutput" class="code-view">ABC output will appear here.</pre>
          </section>

          <section class="tab-panel" id="tab-midi" role="tabpanel" hidden>
            <p class="tab-copy">Download a playable MIDI file for your DAW or notation app.</p>
            <a id="midiDownload" class="download-link disabled" href="#" aria-disabled="true">Download MIDI</a>
          </section>

          <section class="tab-panel" id="tab-musicxml" role="tabpanel" hidden>
            <p class="tab-copy">Use MusicXML for the most editable and notation-accurate result.</p>
            <a id="musicxmlDownload" class="download-link disabled" href="#" aria-disabled="true">Download MusicXML</a>
          </section>

          <section class="tab-panel" id="tab-log" role="tabpanel" hidden>
            <pre id="logOutput" class="log-view">Execution log will appear here.</pre>
          </section>
        </article>
      </section>

      <footer class="footer reveal" style="--delay: 0.24s">
        Powered by homr + music21. Browser workflow and API rebuilt for speed and clarity.
      </footer>
    </main>

    <div id="toast" class="toast" role="status" aria-live="polite"></div>

    <script src="/app.js" defer></script>
  </body>
</html>
